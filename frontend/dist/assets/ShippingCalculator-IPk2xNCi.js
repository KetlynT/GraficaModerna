import{c as E,r as l,j as e,B as P,z,P as s}from"./index-rlvyAQjv.js";import{L as D,S as N}from"./shippingService-DcU-EXS8.js";import{T as L}from"./truck-DlIyHYNf.js";import{C as R}from"./circle-alert-DiXs9p5I.js";/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["path",{d:"M5 12h14",key:"1ays0h"}]],I=E("minus",$),k=({items:d=[],productId:u=null,onSelectOption:i,className:v})=>{const[p,C]=l.useState(""),[o,g]=l.useState(null),[a,x]=l.useState(null),[y,m]=l.useState(!1),[f,c]=l.useState(""),S=async r=>{var h,b;r.preventDefault();const n=p.replace(/\D/g,"");if(n.length!==8){c("Digite um CEP válido (8 números).");return}m(!0),c(""),g(null),x(null),i&&i(null);try{let t=[];if(u)t=await N.calculateForProduct(u,n);else if(d.length>0)t=await N.calculate(n,d);else{c("Nenhum item para calcular."),m(!1);return}g(t)}catch(t){console.error(t);const j=((b=(h=t.response)==null?void 0:h.data)==null?void 0:b.message)||"Erro ao calcular frete. Verifique o CEP.";c(j),z.error(j)}finally{m(!1)}},w=r=>{x(r),i&&i(r)};return e.jsxs("div",{className:`bg-gray-50 p-5 rounded-lg border border-gray-200 ${v}`,children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-700 mb-3 flex items-center gap-2",children:[e.jsx(L,{size:18,className:"text-primary"})," Calcular Frete e Prazo"]}),e.jsxs("form",{onSubmit:S,className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",placeholder:"Digite seu CEP",maxLength:"9",className:"flex-1 border border-gray-300 rounded px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-primary bg-white",value:p,onChange:r=>C(r.target.value.replace(/\D/g,"").replace(/^(\d{5})(\d)/,"$1-$2"))}),e.jsx(P,{type:"submit",disabled:y,size:"sm",className:"bg-gray-800 hover:bg-gray-900",children:y?e.jsx(D,{className:"animate-spin",size:16}):"OK"})]}),f&&e.jsxs("div",{className:"text-red-500 text-sm mb-3 flex items-center gap-1 bg-red-50 p-2 rounded border border-red-100",children:[e.jsx(R,{size:14})," ",f]}),o&&e.jsxs("div",{className:"space-y-2 animate-in fade-in slide-in-from-top-2",children:[o.length===0&&e.jsx("div",{className:"text-sm text-gray-500",children:"Nenhuma opção de entrega encontrada para este CEP."}),o.map((r,n)=>e.jsxs("div",{onClick:()=>w(r),className:`flex justify-between items-center p-3 rounded border cursor-pointer transition-all ${(a==null?void 0:a.name)===r.name?"bg-primary/5 border-primary ring-1 ring-primary":"bg-white border-gray-200 hover:border-primary/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border flex items-center justify-center ${(a==null?void 0:a.name)===r.name?"border-primary":"border-gray-300"}`,children:(a==null?void 0:a.name)===r.name&&e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full"})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-gray-800 text-sm block",children:r.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Até ",r.deliveryDays," dias úteis"]})]})]}),e.jsx("span",{className:"font-bold text-green-700 text-sm",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(r.price)})]},n))]})]})};k.propTypes={items:s.arrayOf(s.shape({productId:s.string.isRequired,quantity:s.number.isRequired})),productId:s.string,onSelectOption:s.func,className:s.string};export{I as M,k as S};
