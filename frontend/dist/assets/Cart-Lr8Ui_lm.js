import{u as C,b as I,r as p,j as e,L as S,B as h,f as u,z as j}from"./index-rlvyAQjv.js";import{C as R}from"./CouponInput-DbN0UGcU.js";import{M as B,S as z}from"./ShippingCalculator-IPk2xNCi.js";import{S as g}from"./shopping-bag-DsXWRmP5.js";import{P as F}from"./shippingService-DcU-EXS8.js";import{T as L}from"./couponService-PfZoteme.js";import{A as P}from"./arrow-right-Bdv5Oolo.js";import"./truck-DlIyHYNf.js";import"./circle-alert-DiXs9p5I.js";const $=()=>{const{cartItems:r,updateQuantity:y,removeFromCart:b}=C(),l=I(),[t,f]=p.useState(null),[n,i]=p.useState(null),o=async(s,a,w)=>{const m=a+w;m<1||(await y(s,m),n&&(i(null),j("Quantidade alterada. Por favor, calcule o frete novamente.",{icon:"ðŸšš"})))},N=()=>{if(!u.isAuthenticated()){j("FaÃ§a login para finalizar a compra."),l("/login",{state:{from:"/carrinho"}});return}l("/checkout",{state:{coupon:t}})},c=r.reduce((s,a)=>s+(a.totalPrice||0),0),d=t?c*(t.discountPercentage/100):0,x=n?n.price:0,v=c-d+x;return r.length===0?e.jsxs("div",{className:"min-h-[60vh] flex flex-col items-center justify-center text-center px-4",children:[e.jsx("div",{className:"bg-gray-100 p-6 rounded-full mb-4",children:e.jsx(g,{size:48,className:"text-gray-400"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Seu carrinho estÃ¡ vazio"}),e.jsx(S,{to:"/",children:e.jsx(h,{children:"Voltar para a Loja"})})]}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-10",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-8 flex items-center gap-2",children:[e.jsx(g,{})," Meu Carrinho"]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden h-fit",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 text-sm uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Produto"}),e.jsx("th",{className:"p-4 text-center",children:"Qtd"}),e.jsx("th",{className:"p-4 text-right",children:"Total"}),e.jsx("th",{className:"p-4"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:r.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[s.productImage?e.jsx("img",{src:s.productImage,className:"w-16 h-16 object-cover rounded border",alt:""}):e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded border flex items-center justify-center text-xs",children:"Sem Imagem"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-gray-800",children:s.productName||"Item IndisponÃ­vel"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Unit: R$ ",(s.unitPrice||0).toFixed(2)]})]})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-center border rounded-lg w-fit mx-auto",children:[e.jsx("button",{onClick:()=>o(s.productId,s.quantity,-1),className:"px-3 py-1 text-gray-600 hover:bg-gray-100 disabled:opacity-50",disabled:s.quantity<=1,children:e.jsx(B,{size:14})}),e.jsx("span",{className:"px-2 font-medium text-sm w-8 text-center",children:s.quantity}),e.jsx("button",{onClick:()=>o(s.productId,s.quantity,1),className:"px-3 py-1 text-gray-600 hover:bg-gray-100",children:e.jsx(F,{size:14})})]})}),e.jsxs("td",{className:"p-4 text-right font-bold text-primary",children:["R$ ",(s.totalPrice||0).toFixed(2)]}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("button",{onClick:()=>b(s.productId),className:"text-red-500 hover:bg-red-50 p-2 rounded-full",children:e.jsx(L,{size:18})})})]},s.productId||a))})]})}),e.jsx(z,{items:r,onSelectOption:i,className:"bg-white shadow-sm border border-gray-100"})]}),e.jsxs("div",{className:"h-fit space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"font-bold text-gray-800 mb-4 flex items-center gap-2",children:"Cupom de Desconto"}),e.jsx(R,{onApply:f,initialCoupon:t})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-800 mb-4 border-b pb-2",children:"Resumo"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(c)})]}),t&&e.jsxs("div",{className:"flex justify-between text-green-600 font-medium",children:[e.jsxs("span",{children:["Desconto (",t.code,")"]}),e.jsxs("span",{children:["- ",new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(d)]})]}),e.jsxs("div",{className:"flex justify-between text-primary",children:[e.jsx("span",{children:"Frete"}),e.jsx("span",{children:n?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(x):"NÃ£o calculado"})]})]}),e.jsxs("div",{className:"flex justify-between items-center text-lg font-bold text-gray-900 mt-4 pt-4 border-t border-gray-100 mb-6",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{className:"text-2xl text-primary",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(v)})]}),e.jsxs(h,{onClick:N,className:"w-full py-4 text-lg",variant:"success",children:[u.isAuthenticated()?"Continuar para Entrega":"Login para Finalizar"," ",e.jsx(P,{size:20})]})]})]})]})]})};export{$ as Cart};
