import{r as i,j as e,B as f,z as l,P as r}from"./index-rlvyAQjv.js";import{a as p,X as h,C as j}from"./couponService-PfZoteme.js";import{L as v}from"./shippingService-DcU-EXS8.js";const C=({onApply:n,initialCoupon:m=null})=>{const[a,c]=i.useState(""),[t,d]=i.useState(!1),[o,u]=i.useState(m),x=async()=>{if(a){d(!0);try{const s=await j.validate(a);u(s),n(s),l.success(`Cupom ${s.code} aplicado!`),c("")}catch{l.error("Cupom inválido ou expirado."),n(null)}finally{d(!1)}}},g=()=>{u(null),n(null),l.success("Cupom removido.")};return o?e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 flex justify-between items-center animate-in fade-in",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-700",children:[e.jsx(p,{size:18}),e.jsx("span",{className:"font-bold",children:o.code}),e.jsxs("span",{className:"text-xs bg-green-200 px-2 py-0.5 rounded-full",children:["-",o.discountPercentage,"%"]})]}),e.jsx("button",{onClick:g,className:"text-green-600 hover:text-green-800 p-1 hover:bg-green-100 rounded",children:e.jsx(h,{size:16})})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(p,{size:18,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{className:"w-full border border-gray-300 rounded-lg pl-10 p-2.5 outline-none focus:ring-2 focus:ring-primary uppercase transition-all",placeholder:"CÓDIGO",value:a,onChange:s=>c(s.target.value),disabled:t})]}),e.jsx(f,{onClick:x,disabled:t||!a,size:"sm",className:"px-6",children:t?e.jsx(v,{className:"animate-spin",size:18}):"Aplicar"})]})};C.propTypes={onApply:r.func.isRequired,initialCoupon:r.shape({code:r.string,discountPercentage:r.number})};export{C};
